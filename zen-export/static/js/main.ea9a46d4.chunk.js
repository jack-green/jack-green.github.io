(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},18:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),l=a.n(s),o=a(1),c=a.n(o),i=a(2),u=a(3),m=a(4),p=a(6),d=a(5),h=a(7),f=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){var t=a.props.onLogin,n=a.state,r=n.email,s=n.password;e.preventDefault(),t(r,s)},a.state={email:"",password:""},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.loading,a=this.state,n=a.email,s=a.password;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},"Zen Planner Login"),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{method:"post",onSubmit:this.onSubmit},r.a.createElement("div",{className:"alert alert-danger",style:{display:"none"}}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{className:"form-control",type:"text",id:"email",value:n,onChange:function(t){return e.setState({email:t.target.value})},disabled:t})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{className:"form-control",type:"password",id:"password",value:s,onChange:function(t){return e.setState({password:t.target.value})},disabled:t})),t?r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:!0},"Fetching..."):r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Fetch My Results"))))}}]),t}(r.a.Component),v=function(){return r.a.createElement("div",{className:"intro"},r.a.createElement("p",{className:"lead"},"Hey guys,"),r.a.createElement("p",null,"With the move away from Zen Planner to Wodify, I thought i'd throw together a little tool to help make the transition easier."),r.a.createElement("p",null,"Simply enter your Zen Planner login email & password on the left and hit the 'Fetch My Results' button to get a nice list of all the WOD / 1RM results you've put into Zen Planner."),r.a.createElement("p",null,r.a.createElement("em",null,"I double-decker pinky promise that i'm not doing anything dodgy with your Zen Planner password, but feel free to change it before / after doing this or talk to me if you're suspicious.")),r.a.createElement("p",{className:"lead"},"Cheers, Jack"))},b="https://memberappv220.zenplanner.com/auth/v1/login",g="https://memberappapiv220.zenplanner.com/elements/api-v2/profiles/current?_={timestamp}",E="https://memberappapiv220.zenplanner.com/elements/api-v2/workouts/progressResults?personId={personId}&_={timestamp}",y={personId:null,orgId:null,token:null,refreshToken:null,categories:{},csv:null},w=[{id:"skillname",title:"Skill"},{id:"categoryId",title:"Category",value:function(e){return L(e)}},{id:"lastResultText",title:"Last Result"},{id:"lastresult",title:"Last Result (raw)"},{id:"prResultText",title:"PR Result"},{id:"prResult",title:"PR Result (raw)"},{id:"dayssince",title:"Days since"},{id:"dayssince",title:"Date",value:function(e){return moment().subtract(e,"days").format("DD/MM/YYYY")}},{id:"isBenchMark",title:"Is Bench Mark?",value:function(e){return e?"Yes":"No"}},{id:"measurementClass",title:"Measurement Type"},{id:"success",title:"Success?",value:function(e){return e?"Yes":"No"}},{id:"tries",title:"Tries"}];function k(){return{headers:{Authorization:"Bearer "+y.token,"X-Auth-Refresh":y.refreshToken,PartitionId:y.orgId,"Content-Type":"application/json",Accept:"application/json; charset=utf-8"}}}function R(e,t){return Object.keys(t).forEach(function(a){e=e.replace("{".concat(a,"}"),t[a])}),e}function O(){return(new Date).getTime()}function N(e,t){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(c.a.mark(function e(t,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.post(b,{orgId:null,username:t,password:a,requiredRoles:["PORTAL"]}).then(function(e){if("SUCCESS"===e.data.status)return y.token=e.data.token,y.refreshToken=e.data.refreshToken,y.orgId=e.data.organizationUsers[0].organization.id,!0;var t=e.data.status;throw"INVALID"!==t&&"PASSWORD_INCORRECT"!==t||(t="Invalid email / password"),new Error(t)}).catch(function(e){throw console.log("LOGIN ERROR",e),e}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function x(){return I.apply(this,arguments)}function I(){return(I=Object(i.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(R(g,{timestamp:O()}),k()).then(function(e){return y.personId=e.data.payload.person.id,!0}).catch(function(e){throw console.log("FETCH PROFILE ERROR",e),e}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return(C=Object(i.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(R(E,{personId:y.personId,timestamp:O()}),k()).then(function(e){return e.data}).catch(function(e){throw console.log("FETCH RESULTS ERROR",e),e}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function T(e){console.log("cacheCategories",y),e.forEach(function(e){y.categories[e.id]=e.label})}function L(e){return y.categories[e]}function P(e){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(c.a.mark(function e(t){var a,n,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},T(t.skillCategories),(n=[]).push(w.map(function(e){return e.title})),t.results.forEach(function(e){if(e.lastresult){var t;n.push((t=e,w.map(function(e){var a=t[e.id];return"function"===typeof e.value?e.value(a):a})));var r=L(e.categoryId);"undefined"===typeof a[r]&&(a[r]=[]),a[r].push(e)}}),y.csv=n,console.table(n),(r=Object.keys(a)).sort(),s=[],r.forEach(function(e){var t=a[e];t.sort(function(e,t){return e.skillname===t.skillname?0:e.skillname>t.skillname?1:-1}),s.push({name:e,skills:t})}),e.abrupt("return",s);case 12:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function B(e,t,a){return F.apply(this,arguments)}function F(){return(F=Object(i.a)(c.a.mark(function e(t,a,n){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a){e.next=2;break}throw new Error("Email & Password are required");case 2:return n("Logging In",25),e.prev=3,e.next=6,N(t,a);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),e.t0;case 11:return n("Fetching Profile",50),e.prev=12,e.next=15,x();case 15:e.next=20;break;case 17:throw e.prev=17,e.t1=e.catch(12),e.t1;case 20:return n("Fetching Results",75),r=null,e.prev=22,e.next=25,S();case 25:r=e.sent,e.next=31;break;case 28:throw e.prev=28,e.t2=e.catch(22),e.t2;case 31:return n("Formatting Results",100),e.prev=32,e.next=35,P(r);case 35:r=e.sent,e.next=41;break;case 38:throw e.prev=38,e.t3=e.catch(32),e.t3;case 41:return e.abrupt("return",r);case 42:case"end":return e.stop()}},e,this,[[3,8],[12,17],[22,28],[32,38]])}))).apply(this,arguments)}var M=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).back=function(e){var t=a.props.onBack;e.preventDefault(),t()},a.download=function(e){e.preventDefault();var t,a=(t=[],y.csv.forEach(function(e){t.push(e.join(","))}),t.join("\n")),n=document.createElement("a"),r=new Blob(["\ufeff",a]),s=URL.createObjectURL(r);n.href=s,n.download="zen-export.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n)},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"renderCategory",value:function(e){return r.a.createElement("div",{className:"category",key:"cat-".concat(e.name)},r.a.createElement("h2",null,e.name),r.a.createElement("table",{className:"table table-striped table-bordered"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Skill"),r.a.createElement("th",null,"Last Result"),r.a.createElement("th",null,"PR Result"),r.a.createElement("th",null,"Last Attempt"))),r.a.createElement("tbody",null,e.skills.map(function(e){return r.a.createElement("tr",{key:e.skillId},r.a.createElement("td",null,e.skillname),r.a.createElement("td",null,e.lastResultText),r.a.createElement("td",null,e.prResultText),r.a.createElement("td",null,moment().subtract(e.dayssince,"days").format("DD/MM/YYYY")))}))))}},{key:"render",value:function(){var e=this,t=this.props.results;return r.a.createElement("div",{className:"results"},r.a.createElement("div",{className:"my-4 d-flex justify-content-between"},r.a.createElement("a",{href:"/",onClick:this.back,class:"btn btn-secondary"},"Back"),r.a.createElement("a",{href:"/",onClick:this.download,class:"btn btn-primary"},"Download Spreadsheet")),t.map(function(t){return e.renderCategory(t)}))}}]),t}(r.a.Component),Y=function(e){var t=e.status,a=e.error,n=e.progress;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-8 offset-lg-2"},a?r.a.createElement("div",{className:"alert alert-danger text-center"},a):r.a.createElement("div",{className:"alert alert-info text-center"},r.a.createElement("p",null,t),r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",style:{width:"".concat(n,"%")}})))))},A=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).setStatus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;a.setState({status:e,progress:t})},a.login=function(){var e=Object(i.a)(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({error:null,loading:!0}),B(t,n,a.setStatus).then(function(e){a.setState({loading:!1,status:null,results:e})}).catch(function(e){a.setState({error:e.message,status:e,loading:!1})});case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.onBack=function(){a.setState({status:null,error:null,results:null,loading:!1})},a.state={loading:!1,error:null,results:null,status:null,progress:100},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.error,a=e.loading,n=e.status,s=e.progress,l=e.results;return r.a.createElement("div",{className:"app container my-4"},null===l?r.a.createElement("div",{className:"row align-items-center"},r.a.createElement("div",{className:"col-lg-8"},n?r.a.createElement(Y,{status:n,progress:s,error:t}):r.a.createElement(v,null)),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement(f,{onLogin:this.login,loading:a}))):r.a.createElement(M,{results:l,onBack:this.onBack}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,2,1]]]);
//# sourceMappingURL=main.ea9a46d4.chunk.js.map